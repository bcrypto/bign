\begin{appendix}{Ж}{рекомендуемое}
{Теоретико-числовые алгоритмы}\label{NT}

%\hiddensection{Генерация личного ключа по двоичным словам}
%\label{RANDMOD}
%
%\subsection{Входные и выходные данные}
%
%Входными данными алгоритма генерации личного ключа
%по двоичным словам является порядок~$q$ группы 
%точек эллиптической кривой, $2^{2l-1}<q<2^{2l}$, 
%и двоичные символы, вырабатываемые случайно или псевдослучайно,
%по мере необходимости.
%
%Выходными данными является личный ключ~$u\in\{1,2,\ldots,q-1\}$.
%
%\subsection{Переменные}
%
%Используeтся переменная~$t\in\{0,1\}^{2l}$.
%Значение~$t$ должно быть уничтожено после использования.
%
%\subsection{Алгоритм генерации личного ключа по двоичным словам}
%\label{RANDMOD.Alg}
%
%Генерация личного ключа состоит в выполнении следующих шагов:
%\begin{enumerate}
%\item
%Сгенерировать очередные~$2l$ двоичных символов 
%и записать их в переменную~$t$.
%\item
%Если~$\overline{t}\not\in\{1,2,\ldots,q-1\}$, 
%то перейти к шагу~1.
%\item
%Установить~$u\leftarrow\overline{t}$.
%\item
%Возвратить~$u$.
%\end{enumerate}

\hiddensection{Проверка простоты алгоритмом Рабина~--- Миллера}\label{NT.PrimeQ}

\subsection{Входные и выходные данные}\label{NT.PrimeQ.InOut}

Входными данными алгоритма Рабина~-- Миллера
являются нечетное число~$n\geq 5$,
простота которого проверяется, и число итераций~$T$.

Выходными данными алгоритма является ответ~\texttt{ДА} или~\texttt{НЕТ}.
Ответ \texttt{ДА} означает, что~$n$, вероятно, простое.
Ответ \texttt{НЕТ} означает, что~$n$~--- составное.

Для простых~$n$ алгоритм всегда выдает верный ответ~\texttt{ДА}. 
%
Для составных~$n$ может быть получен как верный ответ~\texttt{НЕТ},
так и ошибочный ответ~\texttt{ДА}. 
Вероятность ошибочного ответа уменьшается с ростом числа итераций
и не превосходит $2^{-2T}$.
Если $l$~--- длина двоичного представления $n$, т.~е. $2^{l-1}\leq n<2^l$,
то рекомендуется выбирать $T\geq l/4$.

\subsection{Переменные}\label{NT.PrimeQ.Vars}

Используются переменные~$u\in\{2,3,\ldots,n-2\}$
и~$v\in\{1,2,\ldots,n-1\}$.

\subsection{Алгоритм Рабина~--- Миллера}\label{NT.PrimeQ.Alg}

Проверка простоты~$n$ состоит в выполнении следующих шагов:
\begin{enumerate}
\item
Представить~$n$ в виде~$2^s r + 1$,
где $s$~--- натуральное число, $r$~--- нечетное натуральное число.

\item
Для $t=1,2,\ldots,T$ выполнить:
\begin{enumerate}
\item
$u\stackrel{R}{\leftarrow}\{2,3,\ldots,n-2\}$;
\item
$v\leftarrow u^r \bmod n$;
\item
если $v=1$ или $v=n-1$, то перейти к шагу~2.6;
\item
для $i=1,2,\ldots,s-1$ выполнить:
\begin{enumerate}
\item
$v\leftarrow v^2\bmod n$;
\item
если $v=1$, то возвратить \texttt{НЕТ};
\item
если $v=n-1$, то перейти к шагу~2.6;
\end{enumerate}
\item
возвратить \texttt{НЕТ};
\item
продолжить.
\end{enumerate}
\item
Возвратить \texttt{ДА}.
\end{enumerate}

\hiddensection{Вычисление символа Лежандра}\label{NT.Legendre}

\subsection{Входные и выходные данные}\label{NT.Legendre.InOut}

Входными данными алгоритма вычисления символа Лежандра
являются нечетное простое число~$n$ и~$u\in\{0,1,\ldots,n-1\}$.

Выходными данными является символ Лежандра~$\left(\frac{u}{n}\right)$.

\subsection{Переменные}\label{NT.Legendre.Vars}

Входные данные интерпретируются как начальные
значения переменных~$n$ и~$u$.
На шагах алгоритма эти значения изменяются, уменьшаясь.

Используется переменная~$t\in\{-1,1\}$.

\subsection{Алгоритм вычисления символа Лежандра}\label{NT.Legendre.Alg}

Вычисление~$\left(\frac{u}{n}\right)$ 
состоит в выполнении следующих шагов:
\begin{enumerate}
\item
Установить~$t\leftarrow 1$.

\item
Если~$u=0$, то возвратить~$0$.

\item
Если~$u=1$, то возвратить~$t$.

\item
Представить~$u$ в виде~$2^s r$, 
где $s$~--- неотрицательное целое число, 
$r$~--- нечетное число.

\item
Если $s$~--- нечетное, то
\begin{enumerate} 
\item
если~$n\equiv 3\pmod{8}$ или $n\equiv 5\pmod{8}$, 
то $t\leftarrow -t$.
\end{enumerate} 

\item
Если $n\equiv 3\pmod{4}$ и $r\equiv 3\pmod{4}$, 
то $t\leftarrow -t$.

\item
Установить $u\leftarrow n\bmod r$.

\item
Установить $n\leftarrow r$.

\item
Если $n>1$, то перейти к шагу 2.

\item
Возвратить~$t$.
\end{enumerate}

\end{appendix}
