\begin{appendix}{А}{справочное}
{Кодирование идентификаторов объектов}
\label{BER}

\mbox{}

Пусть $D$~--- некоторый объект, 
снабженный идентификатором $\{d_1\ d_2\ \ldots d_n\}$
в соответствии с~ГОСТ~34.973.
%
Допустимый идентификатор должен удовлетворять следующим ограничениям:
$d_1,d_2,\ldots,d_n$~--- неотрицательные целые числа;
$n\geq 2$; $d_1\in\{0,1,2\}$;
если $d_1\in\{0,1\}$, то $d_2<40$.

Для определения $\OID(D)$ числа~$40 d_1 + d_2,d_3,\ldots,d_n$ 
кодируются двоичными словами,
которые последовательно конкатенируются и образуют составное слово~$V$.
%
Каждое кодируемое число~$d$ записывается в виде 
$$
d=\sum_{j=0}^{r}a_j 128^j,\quad
0\leq a_j<128,
$$
где~$a_r\neq 0$, если~$d\neq 0$, и~$r=a_0=0$ при~$d=0$.
%
Затем число~$d$ кодируется словом
$$
\langle 128+a_r \rangle_8\parallel
\langle 128+a_{r-1} \rangle_8\parallel
\ldots\parallel
\langle 128+a_1 \rangle_8\parallel
\langle a_0 \rangle_8.
$$

После определения~$V$ вычисляется его длина $l=|V|/8$ в октетах.  
%
Если~$l<128$, то длина кодируется словом $L=\langle l\rangle_{8}$.
Если $l\geq 128$, то длина представляется в виде
$$
l=\sum_{j=0}^r b_j 256^j,\quad
0\leq b_j<256,\quad
b_r\neq 0,
$$
и кодируется словом 
$$
L=\langle 129+r\rangle_8\parallel
\langle b_r\rangle_8\parallel
\langle b_{r-1}\rangle_8\parallel\ldots\parallel
\langle b_0\rangle_8.
$$

Окончательно $\OID(D)$ определяется как
$$
\OID(D)=\texttt{06}_{16}\parallel L\parallel V.
$$

Например, идентификатору $\{1\ 2\ 112\ 0\ 2\ 0\ 34\ 101\ 31\ 81\}$
соответствуют числа~$42$, 
$112$, 
$0$, 
$2$, 
$0$, 
$34$, 
$101$, 
$31$ 
и~$81$.
Данные числа кодируются словами 
$\texttt{2A}_{16}$, 
$\texttt{70}_{16}$, 
$\texttt{00}_{16}$,
$\texttt{02}_{16}$,
$\texttt{00}_{16}$,
$\texttt{22}_{16}$,
$\texttt{65}_{16}$,
$\texttt{1F}_{16}$
и~$\texttt{51}_{16}$,
которые образуют слово~$V=\texttt{2A7000020022651F51}_{16}$.
Длина~$V$ кодируется словом~$L=\texttt{09}_{16}$.
Окончательно кодовое представление
исходного идентификатора имеет следующий вид: 
$\texttt{06092A7000020022651F51}_{16}$.

\end{appendix}

