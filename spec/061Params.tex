\section{Генерация и проверка параметров эллиптической кривой}\label{PARAMS}

\subsection{Входные и выходные данные}

Входными данными алгоритма генерации параметров эллиптической кривой 
являются уровень стойкости~$l\in\{128,192,256\}$, 
простой модуль~$p$ и целый коэффициент~$a$.
%
Должны выполняться следующие условия: $2^{2l-1}<p<2^{2l}$,
$p\equiv 3\pmod{4}$, $0<a<p$.

Выходными данными алгоритма генерации параметров 
являются параметр~$seed\in\{0,1\}^{64}$, 
коэффициент~$b$ ($0<b<p$), 
порядок~$q$ ($2^{2l-1}<q<2^{2l}$) 
и базовая точка~$G\in E_{a,b}^*(\FF_p)$.

Входными данными алгоритма проверки параметров эллиптической кривой
являются модуль~$p$, коэффициенты $a$ и $b$, 
параметр~$seed$, порядок~$q$ и базовая точка~$G$.
%
Параметры $p$, $a$, $b$, $q$ являются целыми числами,
$seed\in\{0,1\}^{64}$, точка~$G$ задается двумя целыми координатами.

Выходными данными алгоритма проверки параметров 
является ответ~\texttt{ДА} или~\texttt{НЕТ}. 
Ответ~\texttt{ДА} означает, что переданные параметры 
описывают допустимую группу точек эллиптической кривой
и были сгенерированы надлежащим образом.
Ответ~\texttt{НЕТ} означает обратное.

\subsection{Вспомогательные алгоритмы и переменные}
\label{PARAMS.Aux}

{\bf Алгоритм~\algname{belt-hash}}.
Используется алгоритм хэширования~\algname{belt-hash},
определенный в СТБ~34.101.31 (пункт~6.9.3).
Входными данными алгоритма является слово~$X\in\{0,1\}^*$,
выходными~--- хэш-значение~$Y\in\{0,1\}^{256}$.

{\bf Вычисление порядка группы точек}.
На шаге~6 алгоритма генерации параметров 
определяется порядок группы точек эллиптической кривой.
%
Для вычисления порядка может быть использован алгоритм Шуфа
или его модернизации, например алгоритм Шуфа~--- Элкиса~--- Аткина
(см.~\cite{ECC}, пункт~4.2.3).

{\bf Проверка простоты}.
На шаге~7.2 алгоритма генерации параметров и на шаге~2.3
алгоритма проверки параметров проверяется простота чисел.
%
Для проверки рекомендуется использовать алгоритм 
Рабина~--- Миллера, определенный в~\ref{PRIMEQ.Alg}
(приложение~\ref{AUX}).

{\bf Тест на квадратичный вычет.}
На шаге~5.1 алгоритма генерации параметров и на шаге~5.4
алгоритма проверки параметров контролируется, 
что число~$b$ является квадратичным вычетом
по модулю~$p$.
%
Для этого рекомендуется
использовать алгоритм вычисления символа Лежандра,
определенный в~\ref{LEGENDRE.Alg}
(приложение~\ref{AUX}).

{\bf Переменная $t$}.
Используется переменная~$t\in\{0,1\}^{4l}$.

{\bf Переменная $B$}.
Используется переменная~$B\in\{0,1\}^{512}$.

\subsection{Алгоритм генерации параметров эллиптической кривой}\label{GENEC}

Генерация параметров эллиптической кривой состоит в выполнении 
следующих шагов:
\begin{enumerate}
\item
Выбрать произвольным образом $seed$.

\item
Установить~$t\leftarrow \langle p\rangle_{2l}\parallel \langle a\rangle_{2l}$.

\item
Установить
$B\leftarrow 
\algname{belt-hash}(t\parallel seed)
\parallel
\algname{belt-hash}(t\parallel 
(seed\boxplus\langle 1\rangle_{64}))$.

\item
Установить $b\leftarrow \overline{B}\mod p$.

\item
Если нарушается одно из условий:
\begin{enumerate}
\item
$\left(\frac{b}{p}\right)=1$;
\item
$4a^3+27b^2\not\equiv 0\pmod{p}$,
\end{enumerate}
то вернуться к шагу~1.

\item
Установить $q\leftarrow |E_{a,b}(\FF_p)|$.

\item
Если нарушается одно из условий:
\begin{enumerate}
\item
$2^{2l-1}<q<2^{2l}$;
\item
$q$~--- простое;
\item
$p\neq q$;
\item
$p^m\not\equiv 1\pmod{q}$ для~$m=1,2,\ldots,50$,
\end{enumerate}
то вернуться к шагу~1.

\item
Установить $G\leftarrow (0,b^{(p+1)/4}\bmod p)$.

\item
Возвратить $(seed,b,q,G)$.
\end{enumerate}

\subsection{Алгоритм проверки параметров эллиптической кривой}\label{VALEC}

Проверка параметров эллиптической кривой состоит 
в выполнении следующих шагов:
\begin{enumerate}
\item
Определить~$l$ как минимальное натуральное число, 
для которого $p<2^{2l}$.
\item
Если нарушается одно из условий:
\begin{enumerate}
\item
$l\in\{128,192,256\}$;
\item
$2^{2l-1}<p,q<2^{2l}$;
\item
$p,q$~--- простые;
\item
$p\equiv 3\pmod{4}$;
\item
$p\neq q$;
\item
$p^m\not\equiv 1\pmod{q}$ для $m=1,2,\ldots,50$,
\end{enumerate}
то возвратить \texttt{НЕТ}.

\item
Установить~$t\leftarrow \langle p\rangle_{2l}\parallel \langle a\rangle_{2l}$.

\item
Установить
$B\leftarrow 
\algname{belt-hash}(t\parallel seed)
\parallel
\algname{belt-hash}(t\parallel(
seed\boxplus\langle 1\rangle_{64}))$.

\item
Если нарушается одно из условий:
\begin{enumerate}
\item
$0<a,b<p$;
\item
$b\equiv \overline{B}\pmod p$;
\item
$4a^3+27b^2\not\equiv 0\pmod{p}$;
\item
$\left(\frac{b}{p}\right)=1$;
\item
$G=(0,b^{(p+1)/4}\bmod p)$;
\item
$qG=O$,
\end{enumerate}
то возвратить \texttt{НЕТ}.
\item
Возвратить~\texttt{ДА}.
\end{enumerate}


